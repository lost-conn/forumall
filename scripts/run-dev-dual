#!/bin/bash
# Run development environment with two backends and frontend

npx concurrently \
  --names "server0,server1,client" \
  --prefix-colors "blue,magenta,green" \
  "PORT=8080 FORUMALL_DB_PATH=db0 FORUMALL_FRONTEND_MODE=proxy FORUMALL_PROXY_TARGET=http://localhost:5173 cargo run -p forumall-server" \
  "PORT=8081 FORUMALL_DB_PATH=db1 FORUMALL_FRONTEND_MODE=proxy FORUMALL_PROXY_TARGET=http://localhost:5173 cargo run -p forumall-server" \
  "cd crates/client && dx serve --port 5173 --platform ${PLATFORM:-'web'}"
